# Архитектура проекта HIREHI Kotlin

## Обзор

Проект реализует веб-приложение для сбора и отображения QA вакансий с сайта hirehi.ru, построенное на принципах чистой архитектуры.

## Структура проекта

```
src/main/kotlin/com/hirehi/
├── data/                          # Слой данных
│   ├── local/                     # Локальное хранение
│   │   └── JobLocalDataSource.kt  # Работа с файлами
│   ├── remote/                    # Внешние источники
│   │   └── HireHiScraper.kt      # Парсинг hirehi.ru
│   └── repository/                # Реализация репозиториев
│       └── JobRepositoryImpl.kt   # Основной репозиторий
├── domain/                        # Бизнес-логика
│   ├── model/                     # Модели данных
│   │   └── Job.kt                # Модель вакансии
│   ├── repository/                # Интерфейсы
│   │   └── JobRepository.kt      # Интерфейс репозитория
│   └── usecase/                   # Use Cases
│       ├── GetJobsUseCase.kt     # Получение вакансий
│       └── RefreshJobsUseCase.kt # Обновление вакансий
└── presentation/                  # Слой представления
    ├── controller/                # Контроллеры
    │   └── JobController.kt      # Маршруты (не используется)
    └── view/                     # Представления
        └── JobView.kt            # HTML шаблоны
```

## Слои архитектуры

### 1. Domain Layer (Бизнес-логика)
- **Модели**: `Job`, `JobSearchParams`, `JobResponse`
- **Интерфейсы**: `JobRepository`
- **Use Cases**: `GetJobsUseCase`, `RefreshJobsUseCase`

**Принципы:**
- Не зависит от внешних слоев
- Содержит только бизнес-логику
- Легко тестируется

### 2. Data Layer (Данные)
- **Remote**: Парсинг внешних источников
- **Local**: Кэширование в файлах
- **Repository**: Реализация интерфейсов

**Принципы:**
- Реализует интерфейсы из Domain
- Инкапсулирует источники данных
- Обрабатывает ошибки сети

### 3. Presentation Layer (Представление)
- **View**: HTML генерация
- **Controller**: Маршруты Ktor
- **Main**: Точка входа приложения

**Принципы:**
- Только отображение данных
- Не содержит бизнес-логики
- Легко заменить на другое представление

## Поток данных

```
1. HTTP Request → Main.kt
2. Main.kt → UseCase
3. UseCase → Repository
4. Repository → Scraper/LocalDataSource
5. Data → Repository → UseCase → View
6. View → HTML Response
```

## Технологический стек

### Backend
- **Kotlin** - основной язык
- **Ktor** - веб-фреймворк
- **Jsoup** - парсинг HTML
- **Kotlinx.html** - генерация HTML
- **Kotlinx.serialization** - JSON

### Инфраструктура
- **Gradle** - сборка
- **Docker** - контейнеризация
- **Render.com** - хостинг

## API Endpoints

| Метод | Путь | Описание |
|-------|------|----------|
| GET | `/` | Главная страница с вакансиями |
| GET | `/api/jobs` | JSON список вакансий |
| POST | `/api/refresh` | Обновление данных |
| GET | `/api/status` | Статус приложения |

## Особенности реализации

### Кэширование
- Данные сохраняются в `hirehi_jobs.json`
- Время последнего обновления в `last_update.txt`
- Автоматическое обновление через 1 час

### Парсинг
- Использует Jsoup для извлечения данных
- Поддерживает альтернативные селекторы
- Фильтрация по ключевым словам

### Обработка ошибок
- Graceful degradation при ошибках сети
- Возврат кэшированных данных
- Логирование ошибок

## Готовность к расширению

### Android приложение
- REST API готов для интеграции
- JSON формат данных
- CORS настроен

### Дополнительные источники
- Легко добавить новые скраперы
- Интерфейс `JobRepository` позволяет разные реализации
- Модульная архитектура

### Масштабирование
- Stateless приложение
- Готово для горизонтального масштабирования
- Docker контейнеризация

## Преимущества архитектуры

1. **Разделение ответственности** - каждый слой имеет свою задачу
2. **Тестируемость** - легко писать unit тесты
3. **Гибкость** - легко заменить любой компонент
4. **Масштабируемость** - готово к росту
5. **Поддерживаемость** - понятная структура кода

## Планы развития

- [ ] Добавить базу данных (PostgreSQL)
- [ ] Реализовать аутентификацию
- [ ] Добавить уведомления
- [ ] Расширить фильтрацию
- [ ] Добавить аналитику
- [ ] Создать Android приложение
